<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="一个博客">
<meta property="og:type" content="website">
<meta property="og:title" content="追寻事">
<meta property="og:url" content="http://tedzhang.cc/index.html">
<meta property="og:site_name" content="追寻事">
<meta property="og:description" content="一个博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="追寻事">
<meta name="twitter:description" content="一个博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://tedzhang.cc/"/>





  <title>追寻事</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">追寻事</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/20/poem_life/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/20/poem_life/" itemprop="url">牌坊</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-20T07:49:50+08:00">
                2017-12-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>绵延的山路上有座牌坊<br>高大而鲜亮<br>牌坊的这头通向前世<br>牌坊的那头通向今生 </p>
<p>矮小的山丘上有盏路灯<br>灯光熹微昏黄<br>照得到的地方是地狱<br>照不到的地方是天堂</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/yum_repo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/yum_repo/" itemprop="url">RedHat 替换yum源</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>RedHat</code> 安装成功后，需要安装软件包，默认是官方的yum源，但是需要注册，果断舍弃。改用163的yum源</p>
<ol>
<li><code>rpm -qa | grep yum</code> 检查是否安装yum</li>
<li><code>rpm -qa|grep yum|xargs rpm -e --nodeps</code> 删除原有的yum源</li>
<li><code>rpm -qa |grep yum</code> 确认是否清除</li>
<li><p>下载相关包，因为有变化，所以需要自己找，我是在<a href="http://mirrors.163.com/centos/6/os/x86_64/Packages/" target="_blank" rel="noopener">163镜像</a>找的。下载</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirrors.163.com/centos/6/os/x86_64/Packages/python-iniparse-0.3.1-2.1.el6.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/6/os/x86_64/Packages/yum-3.2.29-73.el6.centos.noarch.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/6/os/x86_64/Packages/yum-metadata-parser-1.1.2-16.el6.x86_64.rpm</span><br><span class="line">wget http://mirrors.163.com/centos/6/os/x86_64/Packages/yum-plugin-fastestmirror-1.1.30-37.el6.noarch.rpm</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装rpm</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh python-iniparse-0.3.1-2.1.el6.noarch.rpm</span><br><span class="line">rpm -ivh yum-3.2.29-73.el6.centos.noarch.rpm yum-metadata-parser-1.1.2-16.el6.x86_64.rpm yum-plugin-fastestmirror-1.1.30-37.el6.noarch.rpm</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>某个安装包可能会依赖其他包（例如yum和yum-fastestmirror会相互依赖），所以我们可以放一起安装<br>报错 如下：</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error: Failed dependencies:</span><br><span class="line">python-urlgrabber &gt;= 3.9.1-10 is needed by yum-3.2.29-73.el6.centos.noarch</span><br></pre></td></tr></table></figure>
</code></pre><p>于是，在<a href="http://mirrors.163.com/centos/6/os/x86_64/Packages/" target="_blank" rel="noopener">1</a>上找<code>python-urlgrabber &gt;= 3.9.1-10</code>,但是只有<code>python-urlgrabber-3.9.1-11.el6.noarch.rpm</code>,怎么办呢？</p>
<p><code>wget http://mirrors.163.com/centos/6/os/x86_64/Packages/python-urlgrabber-3.9.1-11.el6.noarch.rpm</code> </p>
<p>需要用到rpm的升级功能<code>rpm -Uvh python-urlgrabber-3.9.1-11.el6.noarch.rpm</code>,解决。</p>
<ol>
<li><p>安装163镜像</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/yum.repos.d/</span><br><span class="line">wget http://mirrors.163.com/.help/CentOS6-Base-163.repo</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>并将所有<code>$releasever</code> 改成 6:,<code>vim CentOS6-Base-163.repo</code>,<code>:/1，$s/$releasever/6/g</code></p>
<ol>
<li>清除原有缓存<code>yum clean all</code>,</li>
<li>重新缓存<code>yum makecache</code>,完毕。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/yarn_debug/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/yarn_debug/" itemprop="url">YARN 启动远程调试</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="在RM所在节点的配置"><a href="#在RM所在节点的配置" class="headerlink" title="在RM所在节点的配置"></a><strong>在RM所在节点的配置</strong></h5><ol>
<li>编写ResourceManager的JVM开启远程调试的脚本文件<br>启动： <em>enable_yarn_remote_debug.sh</em><pre><code>`export YARN_RESOURCEMANAGER_OPTS=&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=8000&quot;`
</code></pre>禁用： <em>disable_yarn_remote_debug.sh</em><pre><code>`export YARN_RESOURCEMANAGER_OPTS=` (后面为空)
</code></pre></li>
<li>执行<br> a <code>./enable_yarn_remote_debug.sh</code><br> b <code>source enable_yarn_remote_debug.sh</code></li>
<li>启动 <code>start-yarn.sh</code><br><code>./start-yarn.sh</code> 后，如果有<code>Listening for transport dt_socket at address:8000</code>，说明远程debug启动。</li>
</ol>
<h5 id="在window7上的配置"><a href="#在window7上的配置" class="headerlink" title="在window7上的配置"></a><strong>在window7上的配置</strong></h5><ol>
<li>配置eclipse的远程调试，连接resourcemanager的8000 端口<br> a. 在<code>ResourceManager.java</code> 的main() 方法添加断点</li>
<li>在在ResourceManager类右键–&gt;debug as –&gt; debug configuration…<br> a connectionType:socket attach<br> b Host:ip<br> c port:8000</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/yarn_architecture/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/yarn_architecture/" itemprop="url">Yarn-Architecture</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>Why is Yarn<br>  The fundamental idea of MRv2 is to split up the two major functionalities of the JobTracker, resource management and job scheduling/monitoring, into separate daemons.<br>  The idea is to have a global ResourceManager (RM) and per-application ApplicationMaster (AM). An application is either a single job in the classical sense of Map-Reduce jobs(a whole job ,not task) or a DAG of jobs.<br>  The per-application ApplicationMaster is, in effect, a framework specific library and is tasked with negotiating resources from the ResourceManager and working with the NodeManager(s) to execute and monitor the tasks.<br>  <img src="http://hadoop.apache.org/docs/r2.6.4/hadoop-yarn/hadoop-yarn-site/yarn_architecture.gif" alt="the process of Yarn"><br>  The ResourceManager has two main components: Scheduler and ApplicationsManager.<br>  The Scheduler is responsible for allocating resources to the various running applications subject to familiar constraints of capacities, queues etc.The Scheduler is pure scheduler in the sense that it performs no monitoring or tracking of status for the application.Also, it offers no guarantees about restarting failed tasks either due to application failure or hardware failures.The Scheduler performs its scheduling function based the resource requirements of the applications;it does so based on the abstract notion of a resource Container which incorporates elements such as memory, cpu, disk, network etc. </li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/vagrant_guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/vagrant_guide/" itemprop="url">vagrant 简明教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="为什么是vagrant"><a href="#为什么是vagrant" class="headerlink" title="为什么是vagrant"></a>为什么是<code>vagrant</code></h3><p>通过Vagrant封装开发环境，分享给其他队友，队友的环境和你的环境是一样的，解决 代码在我机器上跑得好好的啊！` 的问题。</p>
<h4 id="安装-virtualbox"><a href="#安装-virtualbox" class="headerlink" title="安装 virtualbox"></a>安装 virtualbox</h4><p><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="noopener">virtualbox下载地址</a></p>
<h4 id="安装Vagrant"><a href="#安装Vagrant" class="headerlink" title="安装Vagrant"></a>安装Vagrant</h4><p><a href="https://www.vagrantup.com/downloads.html" target="_blank" rel="noopener">vagrant下载地址</a></p>
<h3 id="vagrant-使用"><a href="#vagrant-使用" class="headerlink" title="vagrant 使用"></a>vagrant 使用</h3><p>设置工程home  <code>mkdir vagrant2 &amp;&amp; cd vagrant2</code></p>
<h4 id="初始化环境"><a href="#初始化环境" class="headerlink" title="初始化环境"></a>初始化环境</h4><h5 id="vagrant-init-ubuntu-trusty64-查看-当前目录下的-Vagrantfile"><a href="#vagrant-init-ubuntu-trusty64-查看-当前目录下的-Vagrantfile" class="headerlink" title="vagrant init ubuntu/trusty64 查看 当前目录下的 Vagrantfile"></a><code>vagrant init ubuntu/trusty64</code> 查看 当前目录下的 <code>Vagrantfile</code></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(&quot;2&quot;) do |config|</span><br><span class="line">    config.vm.box = &quot;ubuntu/trusty64&quot;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>这表示已经有基础环境了。这是针对从0开始的环境。<br>当然，你也可以从已有的环境(打包好的box)当中开始:</p>
<h5 id="vagrant-init-查看-当前目录下的-Vagrantfile"><a href="#vagrant-init-查看-当前目录下的-Vagrantfile" class="headerlink" title="vagrant init 查看 当前目录下的  Vagrantfile"></a><code>vagrant init</code> 查看 当前目录下的  <code>Vagrantfile</code></h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(&quot;2&quot;) do |config|</span><br><span class="line">    config.vm.box = &quot;base&quot;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>Vagrant 支持从本地文件系统或者HTTP URL来添加boxes<br>本地：<code>vagrant box add base precise64.box</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(&quot;2&quot;) do |config|</span><br><span class="line">  config.vm.box = &quot;hashicorp/precise64&quot;</span><br><span class="line">  config.vm.box_url = &quot;http://files.vagrantup.com/precise64.box&quot;</span><br><span class="line">end</span><br></pre></td></tr></table></figure></p>
<p>等价于 <code>vagrant box add base http://files.vagrantup.com/precise64.box</code><br>=&gt; 格式：<strong><em>vagrant box add box_name box_image</em></strong></p>
<h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><p><code>vagrant up</code> 如果本地没有，会从库里拉取，耗些时间。</p>
<h4 id="ssh-连接"><a href="#ssh-连接" class="headerlink" title="ssh 连接"></a>ssh 连接</h4><p><code>vagrant ssh</code> 密码：vagrant</p>
<h4 id="文件同步"><a href="#文件同步" class="headerlink" title="文件同步"></a>文件同步</h4><p>通过 <code>ssh</code> 进入到 box 中去，在 /vagrant 目录下，新建一个 foo 文件。退出到你本机机器上，惊喜地发现多了一个 foo 文件(当然，是在前面设置的 工程home下，我这是 /vagrant2)。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/springboot_jpa_thymeleaf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/springboot_jpa_thymeleaf/" itemprop="url">用idea 从 0 开始搭建 spring boot + jpa + thymeleaf</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="idea-指导"><a href="#idea-指导" class="headerlink" title="idea 指导"></a>idea 指导</h3><h4 id="1-File-gt-New-gt-Project-gt-Spring-Initializr"><a href="#1-File-gt-New-gt-Project-gt-Spring-Initializr" class="headerlink" title="1 File -&gt; New -&gt; Project -&gt; Spring Initializr"></a>1 File -&gt; New -&gt; Project -&gt; Spring Initializr</h4><h4 id="2-SDK-选择-1-8"><a href="#2-SDK-选择-1-8" class="headerlink" title="2 SDK 选择 1.8"></a>2 SDK 选择 1.8</h4><h4 id="3-Project-Metedata-默认"><a href="#3-Project-Metedata-默认" class="headerlink" title="3 Project Metedata 默认"></a>3 Project Metedata 默认</h4><h4 id="4-Dependencies-里面"><a href="#4-Dependencies-里面" class="headerlink" title="4 Dependencies 里面"></a>4 Dependencies 里面</h4><ul>
<li>左边Web 选择Web</li>
<li>左边Template Engines 选择 Thymeleaf</li>
<li>左边SQL 选择 JPA （JPA是封装了Hibernate的数据库连接组件）</li>
</ul>
<h4 id="5-其他默认"><a href="#5-其他默认" class="headerlink" title="5 其他默认"></a>5 其他默认</h4><p>如此，idea的操作完成。</p>
<h3 id="接下来是pom-xml的配置。"><a href="#接下来是pom-xml的配置。" class="headerlink" title="接下来是pom.xml的配置。"></a>接下来是<code>pom.xml</code>的配置。</h3><h4 id="数据库是用的mysql-需要在依赖中加入"><a href="#数据库是用的mysql-需要在依赖中加入" class="headerlink" title="数据库是用的mysql,需要在依赖中加入"></a>数据库是用的mysql,需要在依赖中加入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">	&lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h4 id="对了，在前端页面开发，会用到jquery-和-boostrap-所以"><a href="#对了，在前端页面开发，会用到jquery-和-boostrap-所以" class="headerlink" title="对了，在前端页面开发，会用到jquery 和 boostrap,所以"></a>对了，在前端页面开发，会用到<code>jquery</code> 和 <code>boostrap</code>,所以</h4><p>也需要增加pom.xml 加入依赖（用的是<a href="https://www.webjars.org/" target="_blank" rel="noopener">webjars</a>）,真是太太太太方便了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--WebJars--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.webjars&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;bootstrap&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;3.3.4&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.webjars&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;jquery&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;2.1.4&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h4 id="所以整个pom-xml-文件是："><a href="#所以整个pom-xml-文件是：" class="headerlink" title="所以整个pom.xml 文件是："></a>所以整个pom.xml 文件是：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">	xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">	&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">	&lt;groupId&gt;com.demo&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;monitoring2&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line">	&lt;packaging&gt;jar&lt;/packaging&gt;</span><br><span class="line"></span><br><span class="line">	&lt;name&gt;monitoring2&lt;/name&gt;</span><br><span class="line">	&lt;description&gt;monitoring for jobs&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">	&lt;parent&gt;</span><br><span class="line">		&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">		&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">		&lt;version&gt;1.5.9.RELEASE&lt;/version&gt;</span><br><span class="line">		&lt;relativePath/&gt;</span><br><span class="line">	&lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">	&lt;properties&gt;</span><br><span class="line">		&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line">		&lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;</span><br><span class="line">		&lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line">	&lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">	&lt;dependencies&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</span><br><span class="line">			&lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;!-- jpa --&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">			&lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">			&lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">		&lt;!--WebJars--&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.webjars&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;bootstrap&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;3.3.7&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.webjars&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jquery&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;2.2.4&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">	&lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">	&lt;build&gt;</span><br><span class="line">		&lt;plugins&gt;</span><br><span class="line">			&lt;plugin&gt;</span><br><span class="line">				&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">				&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">			&lt;/plugin&gt;</span><br><span class="line">		&lt;/plugins&gt;</span><br><span class="line">	&lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<h3 id="下来是-application-properties-的配置"><a href="#下来是-application-properties-的配置" class="headerlink" title="下来是 application.properties 的配置"></a>下来是 <code>application.properties</code> 的配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">##jdbc</span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/demo?useUnicode=true&amp;characterEncoding=utf8</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=root</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line"></span><br><span class="line">####jpa</span><br><span class="line">spring.jpa.show-sql = true ##打印相应的sql，便于调试</span><br><span class="line">logging.level.org.springframework.data=DEBUG</span><br><span class="line">spring.jpa.properties.hibernate.hbm2ddl.auto=update</span><br><span class="line">spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect</span><br><span class="line"></span><br><span class="line">##thymeleaf</span><br><span class="line">spring.thymeleaf.prefix=classpath:/templates/</span><br><span class="line">spring.thymeleaf.suffix=.html</span><br><span class="line">spring.thymeleaf.mode=HTML5</span><br><span class="line">spring.thymeleaf.encoding=UTF-8</span><br><span class="line">spring.thymeleaf.content-type=text/html</span><br><span class="line">spring.thymeleaf.cache=false</span><br></pre></td></tr></table></figure>
<h3 id="代码部分"><a href="#代码部分" class="headerlink" title="代码部分"></a>代码部分</h3><h4 id="启动类-Monitoring2Application"><a href="#启动类-Monitoring2Application" class="headerlink" title="启动类: Monitoring2Application"></a>启动类: <code>Monitoring2Application</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">package com.demo.monitor;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class Monitoring2Application &#123;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		SpringApplication.run(Monitoring2Application.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的注解<code>@SpringBootApplication</code> 表示这是 spring boot 的启动。</p>
<h4 id="Model-Host"><a href="#Model-Host" class="headerlink" title="Model:Host"></a>Model:<code>Host</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package com.demo.monitor.model;</span><br><span class="line"></span><br><span class="line">import javax.persistence.Column;</span><br><span class="line">import javax.persistence.Entity;</span><br><span class="line">import javax.persistence.Id;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">@Entity</span><br><span class="line">public class Host implements Serializable&#123;</span><br><span class="line">    @Id</span><br><span class="line">    private String ID;</span><br><span class="line">    @Column(name=&quot;name&quot;)</span><br><span class="line">    private String name;</span><br><span class="line">    @Column(name = &quot;IP&quot;)</span><br><span class="line">    private String IP;</span><br><span class="line">    @Column(name = &quot;MAC&quot;)</span><br><span class="line">    private String MAC;</span><br><span class="line">    @Column(name = &quot;status&quot;)</span><br><span class="line">    private String status;</span><br><span class="line">    @Column(name = &quot;create_time&quot;)</span><br><span class="line">    private Date createTime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>setter</code>、<code>getter</code> 和 <code>toString</code> 就不贴了。</p>
<p>上面的<code>@Entity</code> <code>@Id</code> <code>@Column(name=&quot;name&quot;)</code> 都是JPA 的注解，不要太方便哦。。。</p>
<h4 id="Repository-HostRepository"><a href="#Repository-HostRepository" class="headerlink" title="Repository:HostRepository"></a>Repository:<code>HostRepository</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package com.demo.monitor.repository;</span><br><span class="line"></span><br><span class="line">import com.demo.monitor.model.Host;</span><br><span class="line">import org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line">import org.springframework.data.jpa.repository.Query;</span><br><span class="line"></span><br><span class="line">public interface HostRepository extends JpaRepository&lt;Host,Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">    @Query(value=&quot;select ID,NAME,IP,MAC,STATUS,CREATE_TIME FROM hosts limit 1&quot;,nativeQuery = true)</span><br><span class="line">    Host findHosts();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面是 <code>nativeQuery = true</code> 表示用原生的查询,我喜欢这种方式。</p>
<h4 id="Service：HostService"><a href="#Service：HostService" class="headerlink" title="Service：HostService"></a>Service：<code>HostService</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">package com.demo.monitor.service;</span><br><span class="line"></span><br><span class="line">import com.demo.monitor.model.Host;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line">@EnableAutoConfiguration</span><br><span class="line">public interface HostService &#123;</span><br><span class="line">    Host findHosts() throws Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ServiceImpl-HostServiceImpl"><a href="#ServiceImpl-HostServiceImpl" class="headerlink" title="ServiceImpl: HostServiceImpl"></a>ServiceImpl: <code>HostServiceImpl</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package com.demo.monitor.service.impl;</span><br><span class="line"></span><br><span class="line">import com.demo.monitor.model.Host;</span><br><span class="line">import com.demo.monitor.repository.HostRepository;</span><br><span class="line">import com.demo.monitor.service.HostService;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line">@Service(value=&quot;hostService&quot;)</span><br><span class="line">public class HostServiceImpl implements HostService&#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private HostRepository hostRepository;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Host findHostLimit() throws Exception &#123;</span><br><span class="line">        Host host = hostRepository.findHosts();</span><br><span class="line">        return host;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@Autowired</code> 自动装配这个注解再熟悉不过了。上面的注解<code>@Service(value=&quot;hostService&quot;)</code>，需要看的是<code>hostService</code>,表示依赖注入的实例变量名是<em>hostService</em>，待会在<code>Controller</code>中会用到。注意：@Service是标在Impl类中，不是在Interface中。</p>
<h4 id="Controller：HostController"><a href="#Controller：HostController" class="headerlink" title="Controller：HostController"></a>Controller：<code>HostController</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">package com.demo.monitor.controller;</span><br><span class="line"></span><br><span class="line">import com.demo.monitor.model.Host;</span><br><span class="line">import com.demo.monitor.service.HostService;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.boot.autoconfigure.EnableAutoConfiguration;</span><br><span class="line">import org.springframework.ui.Model;</span><br><span class="line">import org.springframework.web.bind.annotation.*;</span><br><span class="line">import org.springframework.web.servlet.ModelAndView;</span><br><span class="line">import org.thymeleaf.spring4.view.ThymeleafViewResolver;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@EnableAutoConfiguration</span><br><span class="line">public class HostController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private HostService hostService;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(value = &quot;/host&quot;,method = RequestMethod.GET)</span><br><span class="line">    public ModelAndView getHostInfo(@RequestParam(value=&quot;name&quot;,required = false,defaultValue = &quot;world&quot;) String name) throws Exception &#123;</span><br><span class="line">        Host host = hostService.findHosts();</span><br><span class="line">        ModelAndView modelAndView = new ModelAndView(&quot;host&quot;);</span><br><span class="line">        if (host != null)&#123;</span><br><span class="line">        modelAndView.addObject(&quot;message&quot;,host);</span><br><span class="line">        &#125;</span><br><span class="line">        return modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(value = &quot;/&quot;,method = RequestMethod.GET)</span><br><span class="line">    public String getIndex(@RequestParam(value=&quot;name&quot;,required = false,defaultValue = &quot;world&quot;) String name,Model model) throws Exception &#123;</span><br><span class="line">        return &quot;index&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里需要关注的类注解除了<code>@RestController</code>，还有<code>@EnableAutoConfiguration</code>,如果有没有该注解，会报<code>Unable to start embedded container;</code> 的错误。</p>
<p>直接返回String，像上面的<code>index</code>，会返回这个字符串，而不是相应的页面（Why？？？），解决方法还是用<code>ModelAndView</code>.</p>
<h4 id="页面-host-html-注意，后缀名是-html，不是-jsp，静态页面也支持啦，更有利于前后端分离。"><a href="#页面-host-html-注意，后缀名是-html，不是-jsp，静态页面也支持啦，更有利于前后端分离。" class="headerlink" title="页面 host.html 注意，后缀名是.html，不是.jsp，静态页面也支持啦，更有利于前后端分离。"></a>页面 <code>host.html</code> 注意，后缀名是<code>.html</code>，不是<code>.jsp</code>，静态页面也支持啦，更有利于前后端分离。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;/&gt;</span><br><span class="line">&lt;script th:src=&quot;@&#123;/webjars/jquery/2.1.4/jquery.min.js&#125;&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;link th:href=&quot;@&#123;/webjars/bootstrap/3.3.4/css/bootstrap.min.css&#125;&quot; rel=&quot;stylesheet&quot; media=&quot;screen&quot;/&gt;</span><br><span class="line">&lt;head lang=&quot;en&quot;&gt;</span><br><span class="line">    &lt;title&gt;host&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        $(document).ready(function () &#123;</span><br><span class="line">            $(&apos;p&apos;).animate(&#123;</span><br><span class="line">                fontSize:&apos;48px&apos;</span><br><span class="line">            &#125;,&apos;slow&apos;)</span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;.container&quot;&gt;</span><br><span class="line">        &lt;p class=&quot;.h3&quot;&gt;Hello,host&lt;/p&gt;</span><br><span class="line">        &lt;table class=&quot;table table-bordered&quot;&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;ID&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;名称&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;IP&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;MAC地址&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;状态&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;创建时间&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">            &lt;tr th:each=&quot;host:$&#123;message&#125;&quot;&gt;</span><br><span class="line">                &lt;td th:text=&quot;$&#123;message.ID&#125;&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td th:text=&quot;$&#123;message.name&#125;&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a th:text=&quot;$&#123;message.IP&#125;&quot; &gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td th:text=&quot;$&#123;message.MAC&#125;&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td th:text=&quot;$&#123;message.status&#125;&quot;&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a th:text=&quot;$&#123;message.createTime&#125;&quot;&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>jquery 和 bootstrap 的引用方式也是webjars的啦。</li>
<li><code>&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</code> namespace 换成了thymeleaf，前缀是th. </li>
<li>在 idea 中，<code>${message}</code>会报错，说<code>Cannot resolve &#39;message&#39;</code>，不用管，能正常解析。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/python_yield/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/python_yield/" itemprop="url">yield 探讨</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>yield</code> 是怎么个用法<br>在理解<code>yield</code> 之前，你需理解<code>generators</code>是什么。同时，在理解<code>generators</code> 之前，你必须理解<code>iterables</code>.</p>
<h3 id="Iterables"><a href="#Iterables" class="headerlink" title="Iterables"></a>Iterables</h3><p>创建一个list，你可以依次读取里面的元素。依次读取元素被称为<code>iteration</code>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>mylist = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> mylist:</span><br><span class="line"><span class="meta">... </span>   print(i)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure></p>
<p><code>mylist</code> 是一个迭代器。通过<code>list comprehension</code>（列表生成式）创建的list，同样也是一个迭代器。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; mylist = [x*x for x in range(3)]</span><br><span class="line">&gt;&gt;&gt; for i in mylist:</span><br><span class="line">...    print(i)</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">4</span><br></pre></td></tr></table></figure></p>
<p>任何你能使用” <code>for... in...</code>“ 的对象都是迭代器：<code>list</code>,<code>string</code>,<code>files</code>。<br>迭代器好用是因为能随心所欲地读取数据。它会把所有数据都贮存在内存中，所以数据量一旦大了就不行。</p>
<h3 id="Generators"><a href="#Generators" class="headerlink" title="Generators"></a>Generators</h3><p><code>Generators</code> 也是一种迭代器， 但是它的特殊之处在于<strong><em>只能迭代一次</em></strong>。因为它不是把所有数据贮存在内存中，<strong><em>使用时才生成</em></strong>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; mygenerator = (x*x for x in range(3))</span><br><span class="line">&gt;&gt;&gt; for i in mygenerator:</span><br><span class="line">...    print(i)</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">4</span><br></pre></td></tr></table></figure></p>
<p>如你所见，除了将<code>[]</code>替换成<code>()</code>，并没有什么不同。但是，你不能第二次执行 <code>for i in mygenerator</code>,因为<code>generators</code> 只能使用一次。先计算0，然后把0抛弃再计算1，以此类推，直到2.<br>第二次执行<code>mylist</code>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; for i in mylist:</span><br><span class="line">...     print(i)</span><br><span class="line">... </span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">4</span><br></pre></td></tr></table></figure></p>
<p>第二次执行<code>mygenerator</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; for i in mygenerator:</span><br><span class="line">...     print(i)</span><br><span class="line">... </span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="Yield"><a href="#Yield" class="headerlink" title="Yield"></a>Yield</h3><p><code>Yield</code> 用法跟 <code>return</code> 类似，除了它返回 <code>generator</code>.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; def createGenerator():</span><br><span class="line">...     for i in range(3):</span><br><span class="line">...         yield i*i</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; mygenerator = createGenerator() </span><br><span class="line">&gt;&gt;&gt; print(mygenerator)</span><br><span class="line">&lt;generator object createGenerator at 0x7f4f5c48cf50&gt;</span><br><span class="line">&gt;&gt;&gt; for i in mygenerator:</span><br><span class="line">...     print(i)</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">4</span><br></pre></td></tr></table></figure></p>
<p>为掌握<code>yield</code>,你必须理解<strong><em>你调用这个函数，它并没有执行*</em></strong>，只是返回了一个<code>generator object</code>,这有点绕弯。<br>然后，你对<code>generator</code> 用”<code>for ... in ...</code>“时,你的代码才执行。</p>
<p>在一个 generator function 中，如果没有 return，则默认执行至函数完毕，如果在执行过程中 return，则直接抛出 StopIteration 终止迭代</p>
<h3 id="yield-from"><a href="#yield-from" class="headerlink" title="yield from"></a>yield from</h3><ul>
<li>使用场景?<pre><code>+ 为何比作协程?
</code></pre></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/python_guide-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/python_guide-1/" itemprop="url">python 基础</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>list</p>
<ul>
<li><p>Python内置的一种数据类型是列表：list。list是一种有序的集合，可以随时添加和删除其中的元素。</p>
<blockquote>
<p>classmates = [‘Michael’, ‘Bob’, ‘Tracy’]<br>classmates<br>[‘Michael’, ‘Bob’, ‘Tracy’]</p>
</blockquote>
<p>变量<code>classmates</code>就是一个list。用<code>len()</code>函数可以获得list元素的个数.<br>如果要取最后一个元素，除了计算索引位置外，还可以用<code>-1</code>做索引，直接获取最后一个元素</p>
</li>
</ul>
</li>
<li><p>tuple tuple是一种不可变的集合，所有的不可变，是tuple的指向不可变，(java中的引用地址)。用法与list类似.（1,2,3）（1,）</p>
</li>
<li><p>dict </p>
<blockquote>
<p>d = {‘Michael’: 95, ‘Bob’: 75, ‘Tracy’: 85}<br>d[‘Michael’]  –方式一<br>d.get(‘Thomas’, -1) – 方式二<br>d.pop(‘Bob’)</p>
</blockquote>
</li>
</ul>
<p>和list比较，dict有以下几个特点：</p>
<p>查找和插入的速度极快，不会随着key的增加而增加；<br>需要占用大量的内存，内存浪费多。<br>而list相反：</p>
<p>查找和插入的时间随着元素的增加而增加；<br>占用空间小，浪费内存很少。<br>所以，dict是用空间来换取时间的一种方法。</p>
<ul>
<li><p>set</p>
<ul>
<li><p>和dict类似，也是一组key的集合，但不存储value。由于key不能重复，所以，在set中，没有重复的key。<br>要创建一个set，需要提供一个list作为输入集合：</p>
<blockquote>
<p>s = set([1, 2, 3])   –&gt; 里面是个list</p>
</blockquote>
<p>注意，传入的参数[1, 2, 3]是一个list，而显示的{1, 2, 3}只是告诉你这个set内部有1，2，3这3个元素，显示的顺序也不表示set是有序的。</p>
</li>
</ul>
</li>
<li><p>再议不可变对象</p>
<ul>
<li>上面我们讲了，str是不变对象，而list是可变对象</li>
<li>对于不变对象来说，调用对象自身的任意方法，也不会改变该对象自身的内容。相反，这些方法会创建新的对象并返回，这样，就保证了不可变对象本身永远是不可变的</li>
</ul>
</li>
<li><p>函数（函数也有类和对象的概念) </p>
<ul>
<li>函数名其实就是指向一个函数对象的引用，完全可以把函数名赋给一个变量，相当于给这个函数起了一个“别名”：<blockquote>
<p>a = abs # 变量a指向abs函数 –abs 指向了一个abs()的对象<br>a(-1) # 所以也可以通过a调用abs函数<br>1</p>
</blockquote>
</li>
<li>如果想定义一个什么事也不做的空函数，可以用<code>pass</code>语句：</li>
<li><p>如果有必要，可以先对参数的数据类型做检查；</p>
</li>
<li><p>函数体内部可以用<code>return</code>随时返回函数结果；</p>
</li>
<li><p>函数执行完毕也没有<code>return</code>语句时，自动<code>return None</code>。</p>
</li>
<li><p>函数可以同时返回多个值，但其实就是一个<code>tuple</code>。</p>
</li>
</ul>
</li>
<li><p>迭代 </p>
<ul>
<li><p>判断是否是可迭代对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from collections import Iterable</span><br><span class="line">isinstance(&apos;abc&apos;, Iterable) # str是否可迭代</span><br><span class="line">    True</span><br><span class="line">isinstance([1,2,3], Iterable) # list是否可迭代</span><br><span class="line">    True</span><br><span class="line">isinstance(123, Iterable) # 整数是否可迭代</span><br><span class="line">    False</span><br></pre></td></tr></table></figure>
</li>
<li><p>Python的for循环抽象程度要高于Java的for循环，因为Python的for循环不仅可以用在list或tuple上，还可以作用在其他可迭代对象.<br>默认情况下，dict迭代的是key。如果要迭代value，可以用 <code>for value in d.values()</code>，如果要同时迭代key和value，可以用<code>for k, v in d.items()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;&apos;a&apos;: 1, &apos;b&apos;: 2, &apos;c&apos;: 3&#125;</span><br><span class="line">for key in d:</span><br><span class="line">     print(key)</span><br><span class="line">a</span><br><span class="line">c</span><br><span class="line">b</span><br></pre></td></tr></table></figure>
</li>
<li><p>由于字符串也是可迭代对象，因此，也可以作用于for循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for ch in &apos;ABC&apos;:</span><br><span class="line">    print(ch)</span><br><span class="line">A</span><br><span class="line">B</span><br><span class="line">C</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果要对list实现类似Java那样的下标循环怎么办？Python内置的enumerate函数可以把一个list变成<code>索引-元素</code>对，这样就可以在for循环中同时迭代<code>索引</code>和<code>元素</code>本身：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for i, value in enumerate([&apos;A&apos;, &apos;B&apos;, &apos;C&apos;]):</span><br><span class="line">    print(i, value)</span><br><span class="line">0 A</span><br><span class="line">1 B</span><br><span class="line">2 C</span><br></pre></td></tr></table></figure>
<p>上面的for循环里，同时引用了两个变量，在Python里是很常见的，比如下面的代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for x, y in [(1, 1), (2, 4), (3, 9)]:</span><br><span class="line">    print(x, y)</span><br><span class="line">1 1</span><br><span class="line">2 4</span><br><span class="line">3 9</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>列表生成式, 因为是生成列表，所以需要<code>[ ]</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;    [x * x for x in range(1, 11)]</span><br><span class="line">&gt;    [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]</span><br></pre></td></tr></table></figure>
<p>还可以使用两层循环，可以生成全排列:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; [m + n for m in &apos;ABC&apos; for n in &apos;XYZ&apos;]</span><br><span class="line">&gt; [&apos;AX&apos;, &apos;AY&apos;, &apos;AZ&apos;, &apos;BX&apos;, &apos;BY&apos;, &apos;BZ&apos;, &apos;CX&apos;, &apos;CY&apos;, &apos;CZ&apos;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>生成器(generator)</p>
<ul>
<li><p>要创建一个generator，有很多种方法。第一种方法很简单，只要把一个列表生成式的[]改成()，就创建了一个generator： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; L = [x * x for x in range(10)]</span><br><span class="line">&gt;&gt;&gt; L</span><br><span class="line">[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span><br><span class="line">&gt;&gt;&gt; g = (x * x for x in range(10))</span><br><span class="line">&gt;&gt;&gt; g</span><br><span class="line">&lt;generator object &lt;genexpr&gt; at 0x1022ef630&gt;</span><br></pre></td></tr></table></figure>
<p>创建L和g的区别仅在于最外层的[]和()，L是一个list，而g是一个generator。<br>创建了一个generator后，基本上永远不会调用next()，而是通过for循环来迭代它.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; g = (x * x for x in range(10))</span><br><span class="line">&gt;&gt;&gt; for n in g:</span><br><span class="line">        print(n)</span><br><span class="line">... </span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">9</span><br><span class="line">16</span><br><span class="line">25</span><br><span class="line">36</span><br><span class="line">49</span><br><span class="line">64</span><br><span class="line">81</span><br></pre></td></tr></table></figure>
</li>
<li><p>这就是定义generator的另一种方法。如果一个函数定义中包含yield关键字，那么这个函数就不再是一个普通函数，而是一个generator：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def fib(max):</span><br><span class="line">    n, a, b = 0, 0, 1</span><br><span class="line">    while n &lt; max:</span><br><span class="line">        yield b</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        n = n + 1</span><br><span class="line">    return &apos;done&apos;</span><br></pre></td></tr></table></figure>
<p>这里，最难理解的就是generator和函数的执行流程不一样。函数是顺序执行，遇到return语句或者最后一行函数语句就返回。而变成generator的函数，在每次调用next()的时候执行，遇到yield语句返回，再次执行时从上次返回的yield语句处继续执行。 </p>
</li>
</ul>
</li>
<li><p>难点</p>
<ul>
<li>generator</li>
</ul>
</li>
<li><p>迭代器<br>  我们已经知道，可以直接作用于for循环的数据类型有以下几种：</p>
<ul>
<li><p>一类是集合数据类型，如list、tuple、dict、set、str等；</p>
</li>
<li><p>一类是generator，包括生成器和带yield的generator function。</p>
</li>
<li><p>可以被next()函数调用并不断返回下一个值的对象称为迭代器：Iterator。<br>生成器都是Iterator对象，但list、dict、str虽然是Iterable，却不是Iterator。<br>把list、dict、str等Iterable变成Iterator可以使用iter()函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; isinstance(iter([]), Iterator)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; isinstance(iter(&apos;abc&apos;), Iterator)</span><br><span class="line">True</span><br></pre></td></tr></table></figure>
</li>
<li><p>小结<br>凡是可作用于for循环的对象都是Iterable类型；</p>
<p>凡是可作用于next()函数的对象都是Iterator类型，它们表示一个惰性计算的序列；</p>
<p>集合数据类型如list、dict、str等是Iterable但不是Iterator，不过可以通过iter()函数获得一个Iterator对象。</p>
<p>Python的for循环本质上就是通过不断调用next()函数实现的</p>
<p>这些可以直接作用于for循环的对象统称为可迭代对象：Iterable。</p>
</li>
</ul>
</li>
<li><p>sys.argv –脚本中用的比较多-</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">' a test module '</span></span><br><span class="line"></span><br><span class="line">__author__ = <span class="string">'Michael Liao'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    args = sys.argv</span><br><span class="line">    <span class="keyword">if</span> len(args)==<span class="number">1</span>:</span><br><span class="line">            print(<span class="string">'Hello, world!'</span>)</span><br><span class="line">    <span class="keyword">elif</span> len(args)==<span class="number">2</span>:</span><br><span class="line">        print(<span class="string">'Hello, %s!'</span> % args[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'Too many arguments!'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    test()</span><br></pre></td></tr></table></figure>
<p>  运行python3 hello.py获得的sys.argv就是[‘hello.py’]；<br>  运行python3 hello.py Michael获得的sys.argv就是[‘hello.py’, ‘Michael]。</p>
</li>
<li><p>作用域</p>
<ul>
<li>正常的函数和变量名是公开的（public），可以被直接引用，比如：abc，x123，PI等</li>
<li>特殊变量：<strong>xxx</strong>,自定义变量不能用这种方式</li>
<li>_xxx  protected <code>虽然我可以被访问 ,but,请把我视为私有变量，不要随意访问</code></li>
<li>__xxx private <code>(外部无法直接调用,避免子类继承)</code></li>
<li>这样的函数或变量就是非公开的（private），不应该被直接引用，比如_abc，__abc等，但是能被直接引用。因为Python并没有一种方法可以完全限制访问private函数或变量，但是，从编程习惯上不应该引用private函数或变量。</li>
</ul>
</li>
<li><p>面向对象的四大特性</p>
<ul>
<li>抽象    </li>
<li>封装（封装复杂性，是为了交互的简便性）  </li>
<li>继承（具有父类的特性）</li>
<li>多态 （具有各自特点，以区别去其他）</li>
<li>一切皆为对象</li>
<li>对象–类的实例</li>
<li>类 某个对象的模板</li>
<li>方法 （动态属性）</li>
<li>属性 （静态）</li>
<li>消息传递（对象之间的交互）</li>
<li>类的方法和普通函数没有什么区别，所以，你仍然可以用默认参数、可变参数、关键字参数和命名关键字参数。</li>
</ul>
</li>
</ul>
<p>和静态语言不同，<code>Python允许动态地对实例变量绑定任何数据</code>，也就是说，对于两个实例变量，虽然它们都是同一个类的不同实例，但拥有的变量名称都可能不同.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    </span><br><span class="line">    # self.__name 实现访问控制</span><br><span class="line">    def __init__(self, name, score):</span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__score = score</span><br><span class="line"></span><br><span class="line">    def print_score(self):</span><br><span class="line">        print(&apos;%s: %s&apos; % (self.__name, self.__score))</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; bart = Student(&apos;Bart Simpson&apos;, 59)</span><br><span class="line">&gt;&gt;&gt; lisa = Student(&apos;Lisa Simpson&apos;, 87)</span><br><span class="line">&gt;&gt;&gt; bart.age = 8 #可以动态添加属性</span><br><span class="line">&gt;&gt;&gt; bart.age</span><br><span class="line">8</span><br><span class="line">&gt;&gt;&gt; lisa.age</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">AttributeError: &apos;Student&apos; object has no attribute &apos;age&apos;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class Dog：</span><br><span class="line">    # 类的初始化,资源的预加载</span><br><span class="line">    def __init__(self,name):</span><br><span class="line">        self.class_name = name;</span><br><span class="line">    </span><br><span class="line">    def __auth(self):</span><br><span class="line">        print &quot;can not be called out of class&quot;</span><br><span class="line"></span><br><span class="line">    # 类函数，需要一个自身的引用，Java引用自身是 this,但是this是隐式传入的，而Python需要显式传入</span><br><span class="line">    def bulk(self):</span><br><span class="line">        # 方法之间是相互独立的，唯一的联系就是类本身，所以在函数调用另外的函数，需要加self</span><br><span class="line">        self.__auth() # 在提示中也是 __auth(self)</span><br><span class="line">        print &apos;wang,wang,I am &#123;name&#125;&apos;.format(name = self.class_name)</span><br><span class="line">    def eat(self,food_type)</span><br><span class="line">        if &apos;meat&apos; == food_type:</span><br><span class="line">            print &quot;thanks, I like meat!&quot;</span><br><span class="line">        else:</span><br><span class="line">            print &quot;sorry, I eat only meat!!!&quot;</span><br><span class="line">    #解构器-无须调用，默认执行,做一些后续操作，比如保存资源，释放资源</span><br><span class="line">    def ___del__(self):</span><br><span class="line">        print &quot;I am finished....&quot;</span><br><span class="line"># dog = Dog 没有括号，只声明，没有定义</span><br><span class="line">dog = Dog() // 定义实例 </span><br><span class="line">dog.bulk()</span><br><span class="line">dog.eat(&apos;meat&apos;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>类函数 和 普通函数的区别，须有对自身实例的引用，即 self</p>
</blockquote>
<ul>
<li><p>类的继承</p>
<ul>
<li>动态语言的“鸭子类型”，它并不要求严格的继承体系，一个对象只要“看起来像鸭子，走起路来像鸭子”，那它就可以被看做是鸭子。</li>
<li>对于静态语言（例如Java）来说，如果需要传入Animal类型，则传入的对象必须是Animal类型或者它的子类，否则，将无法调用run()方法。</li>
<li><p>对于Python这样的动态语言来说，则不一定需要传入Animal类型。我们只需要保证传入的对象有一个run()方法就可以了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    # 没有继承Animal类型，只是实现了run方法</span><br><span class="line">    class Timer(object):</span><br><span class="line">        def run(self):</span><br><span class="line">            print(&apos;Start...&apos;)</span><br><span class="line">```   </span><br><span class="line">+  获取对象信息</span><br><span class="line">    + 判断对象类型/基本类型/变量指向函数或者类，使用`type()`函数.返回对应的Class类型</span><br><span class="line">    &gt; type(123)</span><br><span class="line">    &gt; &lt;class &apos;int&apos;&gt;</span><br><span class="line">    + 我们要判断class的类型，可以使用`isinstance()`函数</span><br><span class="line">    + 能用`type()`判断的基本类型也可以用`isinstance()`判断：</span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>isinstance(‘a’, str)<br>True<br>isinstance(123, int)<br>True</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ 还可以判断一个变量是否是某些类型中的一种，比如下面的代码就可以判断是否是list或者tuple</span><br></pre></td></tr></table></figure>
<p>isinstance([1, 2, 3], (list, tuple))<br>True<br>isinstance((1, 2, 3), (list, tuple))<br>True</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
</blockquote>
<p>class Dog(Animal):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    +　`dir()`,获得一个对象的所有属性和方法-dir(&apos;abc&apos;)</span><br><span class="line"></span><br><span class="line">+ @property 属性</span><br><span class="line">    + 未使用 @property</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>class Student(object):</p>
<pre><code>def get_score(self):
     return self._score

def set_score(self, value):
    if not isinstance(value, int):
        raise ValueError(&apos;score must be an integer!&apos;)
    if value &lt; 0 or value &gt; 100:
        raise ValueError(&apos;score must between 0 ~ 100!&apos;)
    self._score = value
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">    s= Student()</span><br><span class="line">    s.set_score(100)</span><br><span class="line">    s.get_score()</span><br><span class="line">    &gt; 100</span><br><span class="line">    s.set_score(9999) --</span><br><span class="line">    ValueError: score must between 0 ~ 100!</span><br></pre></td></tr></table></figure>
<p>有没有既能检查参数，又可以用类似属性这样简单的方式来访问类的变量呢？</p>
<pre><code>+ 使用 @property
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def score(self):</span><br><span class="line">        return self._score</span><br><span class="line"></span><br><span class="line">    @score.setter</span><br><span class="line">    def score(self, value):</span><br><span class="line">        if not isinstance(value, int):</span><br><span class="line">            raise ValueError(&apos;score must be an integer!&apos;)</span><br><span class="line">        if value &lt; 0 or value &gt; 100:</span><br><span class="line">            raise ValueError(&apos;score must between 0 ~ 100!&apos;)</span><br><span class="line">        self._score = value</span><br></pre></td></tr></table></figure>
<p>把一个getter方法变成属性，只需要加上@property就可以了，此时，@property本身又创建了另一个装饰器@score.setter，负责把一个setter方法变成属性赋值，于是，我们就拥有一个可控的属性操作：</p>
<blockquote>
<p>设置和获取都是(属性)score, xxx.setter中的xxx 是方法名，这里是score<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s= Student()</span><br><span class="line">s.score = 100</span><br><span class="line">s.score</span><br><span class="line">&gt;100</span><br><span class="line">s.score = 999</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>若只要get，不要set，那就只要@property，不要 @xxx.setter</p>
<ul>
<li>定制类<br>类似<code>__slots__</code>这种形如<code>__xxx__</code>的变量或者函数名就要注意，这些在Python中是有特殊用途的.<ul>
<li><code>__str__</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; class Student(object):</span><br><span class="line">...     def __init__(self, name):</span><br><span class="line">...         self.name = name</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; print(Student(&apos;Michael&apos;))</span><br><span class="line">&lt;__main__.Student object at 0x109afb190&gt;</span><br><span class="line"></span><br><span class="line">------------------使用__str__的分割线----------------------</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; class Student(object):</span><br><span class="line">...     def __init__(self, name):</span><br><span class="line">...         self.name = name</span><br><span class="line">...     def __str__(self):</span><br><span class="line">...         return &apos;Student object (name: %s)&apos; % self.name</span><br><span class="line">...</span><br><span class="line">(1)&gt;&gt;&gt; print(Student(&apos;Michael&apos;))</span><br><span class="line">Student object (name: Michael)</span><br><span class="line"></span><br><span class="line">(2)&gt;&gt;&gt; s = Student(&apos;Michael&apos;)</span><br><span class="line">&gt;&gt;&gt; s</span><br><span class="line">&lt;__main__.Student object at 0x109afb310&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>(1) 跟 (2)的差别.因为直接显示变量调用的不是<code>__str__()</code>，而是<code>__repr__()</code>，两者的区别是<code>__str__()</code>返回用户看到的字符串，而<code>__repr__()</code>返回程序开发者看到的字符串，也就是说，<code>__repr__()</code>是为调试服务的。<br>解决办法是再定义一个<code>__repr__()</code>。但是通常<code>__str__()</code>和<code>__repr__()</code>代码都是一样的，所以，有个偷懒的写法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name = name</span><br><span class="line">    def __str__(self):</span><br><span class="line">        return &apos;Student object (name=%s)&apos; % self.name</span><br><span class="line">    __repr__ = __str__</span><br></pre></td></tr></table></figure></p>
<pre><code>+ `__getattr__`
正常情况下，当我们调用类的方法或属性时，如果不存在，就会报错。比如定义Student类：
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.name = &apos;Michael&apos;</span><br></pre></td></tr></table></figure>
<p>调用<code>name</code>属性，没问题，但是，调用不存在的<code>score</code>属性，就有问题了：    </p>
<ul>
<li><p>装饰器</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">def timeit(func):</span><br><span class="line">    def wrapper():</span><br><span class="line">       start = time.clock()</span><br><span class="line">       func()</span><br><span class="line">       end = time.clock()</span><br><span class="line">       print &apos;used:&apos;, end-start </span><br><span class="line">    return wrapper</span><br><span class="line"></span><br><span class="line"># 加上 @timeit 表示 foo = timeit(foo)    </span><br><span class="line">@timeit</span><br><span class="line">def foo():</span><br><span class="line">    print &apos;in foo()&apos;</span><br><span class="line">    </span><br><span class="line">foo()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>先打印 ‘in foo(),再打印 used:…. ‘</p>
</blockquote>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/python_django/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/python_django/" itemprop="url">python-django</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="确认环境的安装"><a href="#确认环境的安装" class="headerlink" title="确认环境的安装"></a><strong>确认环境的安装</strong></h3><pre><code>apt-get install pip
pip install django
-&gt; django 版本更新
sudo apt-get install python-setuptools
sudo easy_install --upgrade django
确认安装成功：

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> django</span><br><span class="line">django.VERSION</span><br></pre></td></tr></table></figure>
</code></pre><h3 id="建立-Django-project"><a href="#建立-Django-project" class="headerlink" title="建立 Django project"></a><strong>建立 Django project</strong></h3><p><code>django-admin.py</code> 建立 Django project</p>
<blockquote>
<p><code>root@ubuntu:~/PycharmProjects# django-admin.py startproject DjangoDemo</code></p>
</blockquote>
<p>进入工程目录，结构如下：</p>
<blockquote>
<p>DjangoDemo/<br>|– manage.py<br>|– DjangoDemo</p>
</blockquote>
<table>
<thead>
<tr>
<th>指令</th>
<th style="text-align:right">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>django-admin.py startproject <em>project_name</em></td>
<td style="text-align:right">建立Django 工程</td>
</tr>
<tr>
<td>python manage.py -h <em>command_name</em></td>
<td style="text-align:right">查看command 使用方法</td>
</tr>
<tr>
<td>python manage.py runserver</td>
<td style="text-align:right">启动服务器</td>
</tr>
<tr>
<td>python manage.py startapp <em>app_name</em></td>
<td style="text-align:right">新增 Django app</td>
</tr>
</tbody>
</table>
<h3 id="Models"><a href="#Models" class="headerlink" title="Models"></a>Models</h3><h4 id="配置数据库"><a href="#配置数据库" class="headerlink" title="配置数据库"></a>配置数据库</h4><blockquote>
<p># DjangoDemo/settings.py # 没用默认的sqllite<br>需要安装 python-mysql 的 connector<br>    <code>apt-get install python-mysqldb</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    &apos;default&apos;: &#123;</span><br><span class="line">        &apos;ENGINE&apos;: &apos;django.db.backends.mysql&apos;,</span><br><span class="line">        &apos;NAME&apos;:&apos;django&apos;,</span><br><span class="line">        &apos;USER&apos;:&apos;root&apos;,</span><br><span class="line">        &apos;PASSWORD&apos;:&apos;123456&apos;,</span><br><span class="line">        &apos;HOST&apos;:&apos;localhost&apos;,</span><br><span class="line">        &apos;PORT&apos;:&apos;3306&apos;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="写-Model"><a href="#写-Model" class="headerlink" title="写 Model"></a>写 Model</h4><blockquote>
<p>trips/models.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">title = models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line">content = models.TextField(blank=<span class="keyword">True</span>)</span><br><span class="line">photo = models.URLField(blank=<span class="keyword">True</span>)</span><br><span class="line">location = models.CharField(max_length=<span class="number">100</span>)</span><br><span class="line">created_at = models.DateTimeField(auto_now_add=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<ul>
<li>Django 默认为每个Model加上id属性，并设为主键,名为 pk。</li>
<li>Post 的属性<br>| 属性        | 类型  |   说明 | 参数 |<br>| ——–   | —–:  | —–:  |—–:  |<br>| title     | CharField | 标题| max_length=100-不超过100字节|<br>| content     | TextField | 正文| blank=True ,可为空|<br>| photo     | URLField | 照片地址| m同 content，可为空|<br>| location     | CharField | 地点| 同 title|<br>| created_at     | DateTimeField | 创建时间| auto_now_add=True -添加时间，若修改时间，auto_now = True|</li>
</ul>
<p>Model fields 为 Django Model 定义不同属性。</p>
<ul>
<li>CharField - 字符串属性， 适合 title、location 有长度限制的属性</li>
<li>TextField  -合适大量文字的属性</li>
<li>URLField - 资源地址</li>
<li>DateTimeField -时间，会转化成Python <code>datetime</code> 属性</li>
</ul>
<h4 id="同步数据库"><a href="#同步数据库" class="headerlink" title="同步数据库"></a>同步数据库</h4><pre><code>经过 1 配置数据库 2 创建Model 后，神奇的事情发生啦
</code></pre><blockquote>
<p>root@ubuntu:~/PycharmProjects/Django# <code>python manage.py makemigrations</code></p>
</blockquote>
<ul>
<li>这个命令会根据你对Model的操作创建一个 migrations 文件，让 migrate 执行时，根据这个文件更新数据库 ps：查看目录时，trips/ 下面 多了一个 migrations 文件夹，migrations 有 0001_initial.py 文件。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">operations = [</span><br><span class="line">    migrations.CreateModel(</span><br><span class="line">        name=&apos;Post&apos;,</span><br><span class="line">        fields=[</span><br><span class="line">            (&apos;id&apos;, models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name=&apos;ID&apos;)),</span><br><span class="line">            (&apos;title&apos;, models.CharField(max_length=100)),</span><br><span class="line">            (&apos;content&apos;, models.TextField(blank=True)),</span><br><span class="line">            (&apos;photo&apos;, models.URLField(blank=True)),</span><br><span class="line">            (&apos;location&apos;, models.CharField(max_length=100)),</span><br><span class="line">            (&apos;created_at&apos;, models.DateField(auto_now_add=True)),</span><br><span class="line">        ],</span><br><span class="line">    ),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>跟创建的 <code>Post</code> 这个 Model 相对应.</p>
<blockquote>
<p>root@ubuntu:~/PycharmProjects/Django# <code>python manage.py migrate</code></p>
</blockquote>
<ul>
<li>接下来，migrate 会依据 settings.py 中 <code>INSTALLED_APPS</code> 的设置，按照 app 顺序顺序，让Django根据 <code>migration</code> 文件，把models.py 中的信息写入数据库  </li>
</ul>
<h3 id="Admin"><a href="#Admin" class="headerlink" title="Admin"></a>Admin</h3><table>
<thead>
<tr>
<th>指令</th>
<th style="text-align:right">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>python manage.py createsuperuser</td>
<td style="text-align:right">新增 Django 管理者账号</td>
</tr>
</tbody>
</table>
<h3 id="URLS-Controller"><a href="#URLS-Controller" class="headerlink" title="URLS(Controller)"></a>URLS(Controller)</h3><blockquote>
<p>(?P<pk>\d+)<br>\d 代表一個阿拉伯數字</pk></p>
<pre><code>+  + 代表「一個以上」,所以 \d+ 代表一個以上的阿拉伯數字，例如「0」、「99」、「12345」。可是像「8a」就不符合，因為「a」不是數字。
+ 3. (?P&lt;pk&gt;) 代表「把這一串東西抓出來，命名為 pk,所以 (?P&lt;pk&gt;\d+) 代表：抓出一個以上阿拉伯數字，並把抓出來的東西取名為 pk
+ 綜合以上的規則，r&apos;^post/(?P&lt;pk&gt;\d+)/$&apos; 會達成以下的效果
                  URL    符合結果
# http://127.0.0.1/posts/    不符合，因為前面不是 post/ 開頭。
# http://127.0.0.1/post/    不符合，因為後面抓不到數字。
# http://127.0.0.1/post/1/    符合，抓到的 pk 是 1。
# http://127.0.0.1/post/1234/    符合，抓到的 pk 是 1234。
# http://127.0.0.1/post/12ab/    不符合，因為後面有不是數字的東西。
</code></pre></blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://tedzhang.cc/2017/12/14/metal_or_vm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ted1769">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追寻事">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/metal_or_vm/" itemprop="url">容器部署：裸机，虚机哪个更好？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-14T11:33:19+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>翻译自：<a href="http://containerjournal.com/2017/01/25/better-containers-bare-metal-virtual-machines/" target="_blank" rel="noopener">http://containerjournal.com/2017/01/25/better-containers-bare-metal-virtual-machines/</a></p>
<p><code>Docker</code>部署时，一个重要的问题：部署在裸机上还是虚机？</p>
<ul>
<li>裸机的优势：<ul>
<li>更好的性能。性能的测试可以看看这篇<a href="https://www.stratoscale.com/blog/containers/running-containers-on-bare-metal/" target="_blank" rel="noopener">性能测试</a></li>
<li>能访问特殊设备</li>
<li>相对于裸机的非容器化app，更具移植性(protable)</li>
</ul>
</li>
<li>裸机的劣势（是不是就是虚机的优势？）：  <ul>
<li>相对于非容器化的App，还是有性能损失</li>
<li>缺少隔离性，vm有一层重型的hypervisor隔离租户和宿主机，但这并不意味着docker就不安全或者不够稳定。</li>
<li>相对于vm（具备instance复制），需要重新安装docker，或从habor重新拉取image，尽量这并不难，但是额外增加了操作， 相对缺少移植性。</li>
</ul>
</li>
<li>总结：视情况而定</li>
</ul>
<p>承接上面五个字(<em><code>It depends</code></em>),<a href="https://blog.docker.com/2016/04/physical-virtual-container-deployment/" target="_blank" rel="noopener">这</a>是另外一篇相关的讨论,如下。<br>任何IT的决定都由n个因素决定：<code>Performance</code>, <code>scalability</code>, <code>reliability</code>, <code>security</code>, <code>existing systems</code>, <code>current skillsets</code>, and <code>cost</code> （仅举这几个)。所以，当有人决定要在生产环境上容器时，这些因素都应考虑(<code>merit consideration</code>)<br>docker 允许相关人员无视底层的差异无缝（<code>seamlessly</code>）部署applications，不管是裸机还是VM,不管是Datacenter 还是 公有云。但是往哪里部署，这就视情况而定啦。<br>关键是，不要被其中任何一个所局限。你可以轻而易举地从这移植到那里。但是这么多选择，你就得好好斟酌了，这不仅取决于你现在做的，还取决于你将来用它来做什么。<br>所以，我无法确切回答你“应该哪哪部署app”的问题，不过我可以提供一些因素帮助你做决定。<br><code>Latency</code>:不能容忍延迟的应用，放在裸机上更好。这适用于金融行业（例如：交易系统就是个典型例子）<br><code>Capacity</code>:VM 通过优化系统负载来（<code>make their bones</code>），如果你的容器化应用不会消耗物理机上的所有容量，虚机可能更好。<br><code>Mixed Workloads</code>:裸机只能运行一个os实例，如果你想在同一台机器上跑Windows和Linux 容器，虚机更好。<br><code>Disaster Recovery</code>: </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">ted1769</p>
              <p class="site-description motion-element" itemprop="description">一个博客</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ted1769</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
